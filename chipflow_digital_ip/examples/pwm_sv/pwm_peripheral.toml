# PWM Peripheral TOML Binding
# Demonstrates yosys-slang generator for SystemVerilog to RTLIL conversion
#
# This binding defines how the SystemVerilog pwm_peripheral module connects
# to the Amaranth SoC infrastructure and pad ring IOModels.

name = 'pwm_peripheral'

[files]
path = 'examples/pwm_sv'

[generate]
generator = 'yosys_slang'

[generate.yosys_slang]
top_module = 'pwm_peripheral'
defines = { SYNTHESIS = '' }

[clocks]
sys = 'clk_i'

[resets]
sys = 'rst_ni'

# CSR bus interface for register access
[ports.csr]
interface = 'amaranth_soc.csr.Signature'

[ports.csr.params]
addr_width = 8
data_width = 32

[ports.csr.map]
addr = 'i_csr_addr_i'
w_stb = 'i_csr_we_i'
w_data = 'i_csr_wdata_i'
r_data = 'o_csr_rdata_o'

# PWM output pins to pad ring (active drive with output enable)
# Uses GPIOSignature for tristate-capable pads
[pins.pwm]
interface = 'chipflow.platform.GPIOSignature'

[pins.pwm.params]
width = 4

[pins.pwm.map]
gpio.o = 'o_pwm_o'
gpio.oe = 'o_pwm_oe_o'
# Note: gpio.i not mapped - PWM outputs don't read back

# Input capture pins from pad ring (input only)
[pins.capture]
interface = 'chipflow.platform.GPIOSignature'

[pins.capture.params]
width = 4

[pins.capture.map]
gpio.i = 'i_capture_i'
# Note: gpio.o and gpio.oe not mapped - capture is input only

# GPIO pins to pad ring (full bidirectional)
[pins.gpio]
interface = 'chipflow.platform.GPIOSignature'

[pins.gpio.params]
width = 8

[pins.gpio.map]
gpio.i = 'i_gpio_i'
gpio.o = 'o_gpio_o'
gpio.oe = 'o_gpio_oe_o'

# Software driver configuration (optional)
[drivers.raw]
h_files = []
c_files = []
